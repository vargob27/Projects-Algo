<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{user.first_name}}'s Profile</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body>
    <div class="row">
        <h1 id="title">Tickety</h1>
    </div>
    <div class="row">
        <div class="col-1"><a class="btn btn-info" id="space" href="/success">Home</a></div>
        <div class="col-1 offset-10"><a class="btn btn-secondary" href="/logout">Logout</a></div>
    </div>
    <div class="opac">
        <div class="row">
            <div class="bold">First Name: </div>
            <div class="normal">{{user.first_name}}</div>
        </div>
        <div class="row">
            <div class="bold">Last Name: </div>
            <div class="normal">{{user.last_name}}</div>
        </div>
        <div class="row">
            <div class="bold">Email: </div>
            <div class="normal">{{user.email}}</div>
        </div>
        <div class="row">
            <div class="bold">Skills: </div>
            <div class="normal">
                <p>{{user.skill1}}</p>
                <p>{{user.skill2}}</p>
                <p>{{user.skill3}}</p>
            </div>
        </div>
        <div class="row">
            <div class="bold">Created Tickets: </div>
            <div class="normal">{{user.tickets.count}}</div>
        </div>
        <div class="row">
            <div class="bold"># Of Assigned Tickets: </div>
            <div class="normal">{{user.assigned_tasks.count}}</div>
        </div>
    </div>
    {% if userTickets %}
    <h1>Created Tickets</h1>
    <table class="table table-dark">
        <thead>
            <tr>
                <th>Task</th>
                <th>Description</th>
                <th>Hours</th>
                <th>Due Date</th>
                <th>Submitted By</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for task in userTickets %}
            <tr>
                <td><a href="/task/{{task.id}}">{{task.task_name}}</a></td>
                <td>{{task.description}}</td>
                <td>{{task.hours}}</td>
                <td>{{task.due}}</td>
                <td><a href="/user/{{task.creator.id}}">{{task.creator}}</a></td>
                <td><a href="/task/assign/{{task.id}}" class="btn btn-primary">ASSIGN</a>
                    {% if user.id in task.assigned.id %}
                    <a href="/task/{{task.id}}/drop">Drop</a>
                    {% endif %}
                    {% if user.id == task.creator.id %}
                    <a href="/{{task.id}}/delete" class="btn btn-danger">DELETE</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% if assignedTasks %}
    <h1>Assigned Tickets</h1>
    <table class="table table-dark">
        <thead>
            <tr>
                <th>Task</th>
                <th>Description</th>
                <th>Hours</th>
                <th>Due Date</th>
                <th>Submitted By</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for task in assignedTasks %}
            <tr>
                <td><a href="/task/{{task.id}}">{{task.task_name}}</a></td>
                <td>{{task.description}}</td>
                <td>{{task.hours}}</td>
                <td>{{task.due}}</td>
                <td><a href="/user/{{task.creator.id}}">{{task.creator}}</a></td>
                <td><a href="/task/assign/{{task.id}}" class="btn btn-primary">ASSIGN</a>
                    <a href="/task/{{task.id}}/drop" class="btn btn-secondary">Drop</a>
                    <a href="/task/{{task.id}}/complete" class="btn btn-success">Complete</a>
                    {% if user.id == task.creator.id %}
                    <a href="/task/update/{{task.id}}" class="btn btn-warning">Edit</a>
                    <a href="/{{task.id}}/delete" class="btn btn-danger">DELETE</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% if user.id == loggedIn %}
    <a class="btn btn-warning" href="/user/edit/{{user.id}}">Edit Profile</a>
    {% endif %}
</body>

</html>